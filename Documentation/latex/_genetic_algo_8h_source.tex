\hypertarget{_genetic_algo_8h_source}{}\doxysection{Genetic\+Algo.\+h}
\mbox{\hyperlink{_genetic_algo_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <random>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{10 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacenia}{nia}} \{}
\DoxyCodeLine{17     \textcolor{comment}{// <typeparam name="{}Tgene"{} Type of gene, Tgene chromosome[cromosome size] will be created></typeparam>}}
\DoxyCodeLine{18     \textcolor{comment}{// <typeparam name="{}Tfitess"{} Type of fitness of Individual></typeparam>}}
\DoxyCodeLine{19     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Tgene, \textcolor{keywordtype}{int} chromosome\_size, \textcolor{keyword}{typename} Tfitess>}
\DoxyCodeLine{20     \textcolor{keyword}{class }\mbox{\hyperlink{classnia_1_1_individual_inteface}{IndividualInteface}} \{}
\DoxyCodeLine{21     \textcolor{keyword}{public}:}
\DoxyCodeLine{22         Tgene \mbox{\hyperlink{classnia_1_1_individual_inteface_adc4839922a696cfd8e2c6f9d3f758ca2}{chromosome}}[chromosome\_size];}
\DoxyCodeLine{26         \textcolor{keyword}{virtual} Tfitess \mbox{\hyperlink{classnia_1_1_individual_inteface_a7775b803c37ce69e853258ae4b6efd45}{get\_fitness}}() = 0;}
\DoxyCodeLine{30         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classnia_1_1_individual_inteface_af24918421babc9b1f8cafa7e88597ae1}{mutate}}(\textcolor{keywordtype}{double} mutation\_chance) = 0;}
\DoxyCodeLine{31     \};}
\DoxyCodeLine{48     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Indiv\textcolor{keywordtype}{id}ual>}
\DoxyCodeLine{49     \textcolor{keyword}{class }\mbox{\hyperlink{classnia_1_1_genetic_algo}{GeneticAlgo}} \{}
\DoxyCodeLine{50     \textcolor{keyword}{private}:}
\DoxyCodeLine{51         \textcolor{keyword}{static} \textcolor{keywordtype}{bool} comp\_individ(Individual\& l, Individual\& r) \{}
\DoxyCodeLine{52             \textcolor{keywordflow}{return} l.get\_fitness() > r.get\_fitness();}
\DoxyCodeLine{53         \}}
\DoxyCodeLine{54         \textcolor{keyword}{static} Individual* mating\_pool(\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} NUMBER\_OF\_INDIVIDUALS, Individual population[], \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{55             Individual* pool = \textcolor{keyword}{new} Individual[size];}
\DoxyCodeLine{56             std::random\_device rd;  \textcolor{comment}{//Will be used to obtain a seed for the random number engine}}
\DoxyCodeLine{57             std::seed\_seq seed\{ rd(), \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}\textcolor{keyword}{>}(time(\textcolor{keyword}{nullptr})) \}; \textcolor{comment}{// in case random\_device is not implemented, fall back to time(0)}}
\DoxyCodeLine{58             std::mt19937 gen(seed); \textcolor{comment}{//Standard mersenne\_twister\_engine seeded with seed}}
\DoxyCodeLine{59             std::uniform\_int\_distribution<size\_t> pos\_dis(0, NUMBER\_OF\_INDIVIDUALS -\/ 1);}
\DoxyCodeLine{60             \textcolor{comment}{// Tournament selection}}
\DoxyCodeLine{61             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < size; i++) \{}
\DoxyCodeLine{62                 \textcolor{keywordtype}{size\_t} index1 = pos\_dis(gen);}
\DoxyCodeLine{63                 \textcolor{keywordtype}{size\_t} index2 = pos\_dis(gen);}
\DoxyCodeLine{64                 \textcolor{keywordflow}{if} (population[index1].get\_fitness() > population[index2].get\_fitness()) \{}
\DoxyCodeLine{65                     pool[i] = population[index1];}
\DoxyCodeLine{66                 \}}
\DoxyCodeLine{67                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{68                     pool[i] = population[index2];}
\DoxyCodeLine{69             \}}
\DoxyCodeLine{70             \textcolor{keywordflow}{return} pool;}
\DoxyCodeLine{71         \}}
\DoxyCodeLine{72         \textcolor{keyword}{static} \textcolor{keywordtype}{void} next\_generation(\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} NUMBER\_OF\_INDIVIDUALS, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} NUMBER\_OF\_ELITES, \textcolor{keyword}{const} \textcolor{keywordtype}{double} MUTATION\_CHANCE,}
\DoxyCodeLine{73             Individual population[],}
\DoxyCodeLine{74             std::pair<Individual, Individual>(*breed)(\textcolor{keyword}{const} Individual\&, \textcolor{keyword}{const} Individual\&)}
\DoxyCodeLine{75             ) \{}
\DoxyCodeLine{76             \textcolor{keywordtype}{size\_t} m\_pool\_size = NUMBER\_OF\_INDIVIDUALS -\/ NUMBER\_OF\_ELITES;}
\DoxyCodeLine{77             Individual* m\_pool = mating\_pool(NUMBER\_OF\_INDIVIDUALS, population, m\_pool\_size);}
\DoxyCodeLine{78             std::sort(m\_pool, m\_pool + m\_pool\_size, comp\_individ);}
\DoxyCodeLine{79             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < NUMBER\_OF\_ELITES; i++) \{}
\DoxyCodeLine{80                 population[i] = m\_pool[i];}
\DoxyCodeLine{81                 population[i].mutate(MUTATION\_CHANCE);}
\DoxyCodeLine{82             \}}
\DoxyCodeLine{83             \textcolor{keywordtype}{size\_t} ind = NUMBER\_OF\_ELITES;}
\DoxyCodeLine{84             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; ind < NUMBER\_OF\_INDIVIDUALS; i += 2) \{}
\DoxyCodeLine{85                 \textcolor{keywordflow}{if} (i + 1 == m\_pool\_size) \{}
\DoxyCodeLine{86                     population[ind] = m\_pool[i];}
\DoxyCodeLine{87                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{88                 \}}
\DoxyCodeLine{89                 std::pair<Individual, Individual> children = breed(m\_pool[i], m\_pool[i + 1]);}
\DoxyCodeLine{90                 population[ind] = children.first;}
\DoxyCodeLine{91                 population[ind].mutate(MUTATION\_CHANCE);}
\DoxyCodeLine{92                 ind++;}
\DoxyCodeLine{93                 \textcolor{keywordflow}{if} (ind < NUMBER\_OF\_INDIVIDUALS) \{}
\DoxyCodeLine{94                     population[ind] = children.second;}
\DoxyCodeLine{95                     population[ind].mutate(MUTATION\_CHANCE);}
\DoxyCodeLine{96                     ind++;}
\DoxyCodeLine{97                 \}}
\DoxyCodeLine{98             \}}
\DoxyCodeLine{99             \textcolor{keyword}{delete}[] m\_pool;}
\DoxyCodeLine{100         \}}
\DoxyCodeLine{101     \textcolor{keyword}{public}:}
\DoxyCodeLine{111         \textcolor{keyword}{static} Individual \mbox{\hyperlink{classnia_1_1_genetic_algo_a6e05f3e07f35f3d23498dde2905f8fae}{solve}}(\textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} NUMBER\_OF\_INDIVIDUALS, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} NUMBER\_OF\_ELITES,}
\DoxyCodeLine{112             \textcolor{keyword}{const} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} NUMBER\_OF\_GENERATIONS, \textcolor{keyword}{const} \textcolor{keywordtype}{double} MUTATION\_CHANCE, Individual init\_population[],}
\DoxyCodeLine{113             std::pair<Individual, Individual>(*breed)(\textcolor{keyword}{const} Individual\&, \textcolor{keyword}{const} Individual\&)}
\DoxyCodeLine{114             )}
\DoxyCodeLine{115         \{}
\DoxyCodeLine{116             Individual* population = \textcolor{keyword}{new} Individual[NUMBER\_OF\_INDIVIDUALS];}
\DoxyCodeLine{117             Individual prev\_best = init\_population[0];}
\DoxyCodeLine{118             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < NUMBER\_OF\_INDIVIDUALS; i++) \{}
\DoxyCodeLine{119                 population[i] = init\_population[i];}
\DoxyCodeLine{120                 \textcolor{keywordflow}{if} (prev\_best.get\_fitness() < population[i].get\_fitness()) \{}
\DoxyCodeLine{121                     prev\_best = population[i];}
\DoxyCodeLine{122                 \}}
\DoxyCodeLine{123             \}}
\DoxyCodeLine{124             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} i = 0; i < NUMBER\_OF\_GENERATIONS; i++) \{}
\DoxyCodeLine{125                 next\_generation(NUMBER\_OF\_INDIVIDUALS, NUMBER\_OF\_ELITES, MUTATION\_CHANCE, population, breed);}
\DoxyCodeLine{126                 \textcolor{keywordtype}{size\_t} best = 0;}
\DoxyCodeLine{127                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 1; j < NUMBER\_OF\_INDIVIDUALS; j++) \{}
\DoxyCodeLine{128                     \textcolor{keywordflow}{if} (population[j].get\_fitness() > population[best].get\_fitness()) \{}
\DoxyCodeLine{129                         best = j;}
\DoxyCodeLine{130                     \}}
\DoxyCodeLine{131                 \}}
\DoxyCodeLine{132                 \textcolor{keywordflow}{if} (prev\_best.get\_route\_length() == -\/2 || population[best].get\_route\_length() < prev\_best.get\_route\_length()) \{}
\DoxyCodeLine{133                     prev\_best = population[best];}
\DoxyCodeLine{134                 \}}
\DoxyCodeLine{135             \}}
\DoxyCodeLine{136             \textcolor{keyword}{delete}[] population;}
\DoxyCodeLine{137             \textcolor{keywordflow}{return} prev\_best;}
\DoxyCodeLine{138         \}}
\DoxyCodeLine{139     \};}
\DoxyCodeLine{140 \}}

\end{DoxyCode}
